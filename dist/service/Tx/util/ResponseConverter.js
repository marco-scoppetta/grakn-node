"use strict";function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}const GrpcIteratorFactory=require("./GrpcIteratorFactory");function ResponseConverter(a,b){this.iteratorFactory=new GrpcIteratorFactory(b),this.conceptFactory=a}ResponseConverter.prototype.conceptsFromIterator=(()=>{var a=_asyncToGenerator(function*(a){const b=a.hasConceptresponse()?a.getConceptresponse().getIteratorid():a.getIteratorid(),c=this.iteratorFactory.createConceptIterator(b),d=[];for(let b=yield c.nextResult();b;)d.push(this.conceptFactory.createConcept(b)),b=yield c.nextResult();return d});return function(){return a.apply(this,arguments)}})(),ResponseConverter.prototype.conceptFromResponse=function(a){const b=a.hasConceptresponse()?a.getConceptresponse().getConcept():a.getConcept();return this.conceptFactory.createConcept(b)},ResponseConverter.prototype.conceptFromOptional=function(a){const b=a.hasConceptresponse()?a.getConceptresponse().getOptionalconcept():a.getOptionalconcept();return b.hasPresent()?this.conceptFactory.createConcept(b.getPresent()):null},ResponseConverter.prototype.consumeRolePlayerIterator=(()=>{var a=_asyncToGenerator(function*(a){const b=a.getConceptresponse().getIteratorid(),c=this.iteratorFactory.createRolePlayerIterator(b),d=[];for(let b=yield c.nextResult();b;)d.push({role:this.conceptFactory.createConcept(b.getRole()),player:this.conceptFactory.createConcept(b.getPlayer())}),b=yield c.nextResult();return d});return function(){return a.apply(this,arguments)}})(),ResponseConverter.prototype.dataTypeToString=function(a){return 0===a?"String":1===a?"Boolean":2===a?"Integer":3===a?"Long":4===a?"Float":5===a?"Double":6===a?"Date":void 0},ResponseConverter.prototype.getAttributeValueFromResponse=function(a){const b=a.getConceptresponse().getAttributevalue();return b.hasString()?b.getString():b.hasBoolean()?b.getBoolean():b.hasInteger()?b.getInteger():b.hasLong()?b.getLong():b.hasFloat()?b.getFloat():b.hasDouble()?b.getDouble():b.hasDate()?b.getDate():void 0},ResponseConverter.prototype.getOptionalRegex=function(a){const b=a.getConceptresponse().getOptionalregex();return b.hasPresent()?b.getPresent():null},ResponseConverter.prototype.getOptionalPattern=function(a){const b=a.getConceptresponse().getOptionalpattern();return b.hasPresent()?b.getPresent().getValue():null},ResponseConverter.prototype.getOptionalDataType=function(a){const b=a.getConceptresponse().getOptionaldatatype();return b.hasPresent()?this.dataTypeToString(b.getPresent()):null};function parseQueryResult(a,b){if(a.hasOtherresult())return JSON.parse(a.getOtherresult());else{const c=new Map;return a.getAnswer().getAnswerMap().forEach((a,d)=>{c.set(d,b.createConcept(a))}),c}}ResponseConverter.prototype.executeResponse=(()=>{var a=_asyncToGenerator(function*(a){const b=[];if(a.hasIteratorid()){const c=this.iteratorFactory.createQueryIterator(a.getIteratorid());for(let a=yield c.nextResult();a;){const d=parseQueryResult(a,this.conceptFactory);b.push(d),a=yield c.nextResult()}}if(a.hasQueryresult()){const c=a.getQueryresult(),d=parseQueryResult(c,this.conceptFactory);b.push(d)}return b});return function(){return a.apply(this,arguments)}})(),module.exports=ResponseConverter;